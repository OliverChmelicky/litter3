<script src="table-definitions.ts"></script>
<div class="user-container">

  <div class="user-item">
    <img src="{{me.Avatar ? me.Avatar : 'https://geode.science/wp-content/uploads/2018/11/profil-chercheur.png'}}">
  </div>
  <div class="user-item" *ngIf="me">
    <form>
      <label>
        First name:
        <input [(ngModel)]="me.FirstName">
      </label>
      <label>
        Last name:
        <input [(ngModel)]="me.LastName">
      </label>
      <label>
        Email:
        <input [(ngModel)]="me.Email">
      </label>
    </form>
  </div>

  <div class="user-item">
    <label>
      <p>Request for friend</p>
      <input [(ngModel)]="newFriendEmail" placeholder="fill email"/> <br>
    </label>
    <button (click)="sendFriendRequest()">Send Request</button>
  </div>


  <div class="user-item">
    <h3>My friends</h3>
    <table mat-table [dataSource]="myFriendsView" class="mat-elevation-z8">
      <ng-container matColumnDef="first-name">
        <th mat-header-cell *matHeaderCellDef> First name</th>
        <td mat-cell *matCellDef="let element"> {{element.FirstName}} </td>
      </ng-container>

      <ng-container matColumnDef="last-name">
        <th mat-header-cell *matHeaderCellDef> Last name</th>
        <td mat-cell *matCellDef="let element"> {{element.LastName}} </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef> Remove</th>
        <td mat-cell *matCellDef="let element">
          <button (click)="removeFriend(element.UserId)">Remove</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="friendsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: friendsColumns;"></tr>
    </table>

  </div>

  <div class="user-item">
    <h3>My Societies</h3>
    <table mat-table [dataSource]="mySocietiesView" class="mat-elevation-z8">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let element"> {{element.Name}} </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef>Leave</th>
        <td mat-cell *matCellDef="let element">
          <button (click)="leaveSociety(element.Id)">Leave</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="societiesColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: societiesColumns;"></tr>
    </table>
  </div>


  <h3>Received requests</h3>
  <li *ngFor="let request of IreceivedFriendRequests">
    <p>{{request.Email}}</p>
    <p>{{request.CreatedAt}}</p>
    <button (click)="acceptFriendRequest(request.UserId)">Accept</button>
    <button (click)="denyFriendRequest(request.UserId)">Deny</button>
  </li>

  <h3>Send requests</h3>
  <li *ngFor="let request of IsendFriendRequests">
    <p>{{request.Email}}</p>
    <p>{{request.CreatedAt}}</p>
    <button (click)="cancelFriendRequest(request.UserId)">Cancel</button>
    <p>------------</p>
  </li>

</div>

