<script src="../edit-profile/edit-profile.component.ts"></script>
<script src="table-definitions.ts"></script>

<div class="user-container">

  <div class="user-item">
    <img src="{{me.Avatar ? me.Avatar : 'https://geode.science/wp-content/uploads/2018/11/profil-chercheur.png'}}">
  </div>
  <div class="user-item" *ngIf="me">

      <label>
        First name:
        <p>{{me.FirstName}}</p>
      </label>
      <label>
        Last name:
        <p>{{me.LastName}}</p>
      </label>
      <label>
        Email:
        <p>{{me.Email}}</p>
      </label>

    <button mat-raised-button (click)="openDialog()">Edit</button>

  </div>

  <div class="user-item">
    <label>
      <p>Request for friend</p>
      <input [(ngModel)]="newFriendEmail" placeholder="fill email"/> <br>
    </label>
    <button (click)="sendFriendRequest()">Send Request</button>
  </div>


  <div class="user-item my-friends-table">
    <h3>My friends</h3>
    <table mat-table [dataSource]="myFriendsView" class="mat-elevation-z8">
      <ng-container matColumnDef="first-name">
        <th mat-header-cell *matHeaderCellDef> First name</th>
        <td mat-cell *matCellDef="let element"> {{element.FirstName}} </td>
      </ng-container>

      <ng-container matColumnDef="last-name">
        <th mat-header-cell *matHeaderCellDef> Last name</th>
        <td mat-cell *matCellDef="let element"> {{element.LastName}} </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef> Remove</th>
        <td mat-cell *matCellDef="let element">
          <button (click)="removeFriend(element.UserId)">Remove</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="friendsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: friendsColumns;"></tr>
    </table>

  </div>

  <div class="user-item">
    <h3>My Societies</h3>
    <table mat-table [dataSource]="mySocietiesView" class="mat-elevation-z8">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let element"> {{element.Name}} </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef>Leave</th>
        <td mat-cell *matCellDef="let element">
          <button (click)="leaveSociety(element.Id)">Leave</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="societiesColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: societiesColumns;"></tr>
    </table>
  </div>

  <div class="user-item">
    <h3>Received requests</h3>
    <table mat-table [dataSource]="IreceivedFriendRequests" class="mat-elevation-z8">
      <ng-container matColumnDef="first-name">
        <th mat-header-cell *matHeaderCellDef>First name</th>
        <td mat-cell *matCellDef="let element"> {{element.FirstName}} </td>
      </ng-container>

      <ng-container matColumnDef="last-name">
        <th mat-header-cell *matHeaderCellDef>Last name</th>
        <td mat-cell *matCellDef="let element"> {{element.LastName}} </td>
      </ng-container>

      <ng-container matColumnDef="accept-button">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button (click)="acceptFriendRequest(element.UserId)">Accept</button>
        </td>
      </ng-container>

      <ng-container matColumnDef="deny-button">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button (click)="denyFriendRequest(element.UserId)">Deny</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="requestsReceivedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: requestsReceivedColumns;"></tr>
    </table>
  </div>

  <div class="user-item received-requests-table">
    <h3>Send requests</h3>
    <table mat-table [dataSource]="IsendFriendRequests" class="mat-elevation-z8">
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let element"> {{element.Email}} </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button (click)="cancelFriendRequest(element.UserId)">Cancel</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="requestsSendColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: requestsSendColumns;"></tr>
    </table>
  </div>


</div>

